
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Connect 4</title>
<style>
  :root{--glass:rgba(255,255,255,.2);--shadow:rgba(0,0,0,.35);}
  html,body{height:100%;margin:0;background:
    radial-gradient(circle at 20% 10%, #e9feff 0%, #9befff 30%, #5cc9ff 60%, #2b84ff 100%);
    font-family:"Trebuchet MS","Segoe UI",sans-serif;color:#e9f7ff;display:flex;align-items:center;justify-content:center;}
  .panel{width:min(540px,94vw);padding:14px;border-radius:22px;background:var(--glass);
    backdrop-filter:blur(14px);box-shadow:0 18px 40px var(--shadow);}
  canvas{width:100%;height:auto;border-radius:18px;background:rgba(0,0,0,.2);}
  .row{display:flex;gap:10px;justify-content:center;margin-top:8px;}
  .btn{min-height:48px;padding:10px 14px;border-radius:18px;border:none;color:#07304f;
    background:linear-gradient(#fff,#b8f6ff,#5bc9ff);box-shadow:0 8px 16px rgba(0,0,0,.25);font-weight:700;}
</style>
</head>
<body>
<div class="panel">
  <canvas id="c" width="420" height="360"></canvas>
  <div class="row"><button class="btn" id="reset">Restart</button></div>
</div>
<script>
document.addEventListener('DOMContentLoaded',()=>{
  const c=document.getElementById('c'); const ctx=c.getContext('2d');
  const cols=7, rows=6, cell=60;
  let board=Array.from({length:rows},()=>Array(cols).fill(0));
  let turn=1, anim=null, winner=0;

  function drop(col,player){
    for(let r=rows-1;r>=0;r--){
      if(board[r][col]===0){
        anim={col,row:r,y:-cell*2,player};
        board[r][col]=player;
        return true;
      }
    }
    return false;
  }

  function check(){
    const dirs=[[1,0],[0,1],[1,1],[1,-1]];
    for(let r=0;r<rows;r++)for(let c=0;c<cols;c++){
      const p=board[r][c]; if(!p) continue;
      for(const [dx,dy] of dirs){
        let count=1;
        for(let k=1;k<4;k++){
          const nr=r+dy*k,nc=c+dx*k;
          if(nr<0||nr>=rows||nc<0||nc>=cols||board[nr][nc]!==p) break;
          count++;
        }
        if(count===4) return p;
      }
    }
    return 0;
  }

  c.addEventListener('pointerdown',(e)=>{
    if(winner||anim) return;
    const rect=c.getBoundingClientRect();
    const x=e.clientX-rect.left;
    const col=Math.floor(x/(rect.width/cols));
    if(drop(col,1)){
      winner=check();
      if(!winner){requestAnimationFrame(()=>aiMove());}
    }
  });

  function aiMove(){
    if(winner) return;
    const col=Math.floor(Math.random()*cols);
    if(drop(col,2)) winner=check();
  }

  function draw(){
    ctx.clearRect(0,0,c.width,c.height);
    ctx.fillStyle='rgba(0,0,0,0.2)'; ctx.fillRect(0,0,c.width,c.height);
    for(let r=0;r<rows;r++)for(let cc=0;cc<cols;cc++){
      const x=cc*cell+cell/2, y=r*cell+cell/2;
      ctx.fillStyle=board[r][cc]===1?'#ffd84f':board[r][cc]===2?'#7fefff':'rgba(255,255,255,0.3)';
      ctx.beginPath(); ctx.arc(x,y,22,0,Math.PI*2); ctx.fill();
    }
    if(anim){
      anim.y+=12;
      const x=anim.col*cell+cell/2;
      ctx.fillStyle=anim.player===1?'#ffd84f':'#7fefff';
      ctx.beginPath(); ctx.arc(x,anim.y,22,0,Math.PI*2); ctx.fill();
      if(anim.y>=anim.row*cell+cell/2) anim=null;
    }
    if(winner){
      ctx.fillStyle='rgba(255,255,255,0.8)';
      ctx.fillText(winner===1?'You Win!':'AI Wins!',140,30);
    }
    requestAnimationFrame(draw);
  }
  requestAnimationFrame(draw);

  document.getElementById('reset').addEventListener('pointerdown',()=>{
    board=Array.from({length:rows},()=>Array(cols).fill(0)); winner=0; anim=null;
  });
});
</script>
</body>
</html>
